name: Bun Linux Compile

on:
  push:
    branches:
      - main
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  build-linux-executable:
    runs-on: ubuntu-latest # ä½¿ç”¨æ ‡å‡†çš„ Linux ç¯å¢ƒ (å®Œç¾è§£å†³äº¤å‰ç¼–è¯‘é—®é¢˜)

    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ› ï¸ Install Bun
        # ä½¿ç”¨ Bun çš„å®˜æ–¹ Action æˆ–å®‰è£…è„šæœ¬
        uses: oven-sh/setup-bun@v1

      - name: ğŸ“¦ Install dependencies
        run: bun install --frozen-lockfile # ç¡®ä¿ä¾èµ–æ­£ç¡®å®‰è£…

      - name: ğŸ”¨ Compile Bun Executable for Linux
        run: bun build ./src/index.ts --compile --target=bun-linux-x64 --outfile hono-server
        # ä½¿ç”¨ Linux ç¯å¢ƒç¼–è¯‘ Linux å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸ä¼šæŠ¥é”™

      - name: ğŸ”‘ Set Permissions (é‡è¦!)
        run: chmod +x hono-server # ç¡®ä¿å¯æ‰§è¡Œæ–‡ä»¶æœ‰è¿è¡Œæƒé™

      - name: â¬†ï¸ Upload Artifact (ä¸‹è½½åˆ¶å“)
        uses: actions/upload-artifact@v4
        with:
          name: linux-bun-executable
          path: hono-server # ä¸Šä¼ ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶
          retention-days: 7 # åˆ¶å“ä¿å­˜æ—¶é—´
